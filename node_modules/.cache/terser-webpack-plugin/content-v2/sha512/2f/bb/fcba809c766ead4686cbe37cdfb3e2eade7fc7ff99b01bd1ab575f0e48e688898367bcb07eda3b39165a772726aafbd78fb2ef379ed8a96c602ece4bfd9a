{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{340:function(e,t,n){\"use strict\";var r,o=\"object\"==typeof Reflect?Reflect:null,i=o&&\"function\"==typeof o.apply?o.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=o&&\"function\"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){var o,i,a,s;if(\"function\"!=typeof n)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof n);if(void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit(\"newListener\",t,n.listener?n.listener:n),i=e._events),a=i[t]),void 0===a)a=i[t]=n,++e._eventsCount;else if(\"function\"==typeof a?a=i[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(o=l(e))>0&&a.length>o&&!a.warned){a.warned=!0;var c=new Error(\"Possible EventEmitter memory leak detected. \"+a.length+\" \"+String(t)+\" listeners added. Use emitter.setMaxListeners() to increase limit\");c.name=\"MaxListenersExceededWarning\",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function p(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,i(this.listener,this.target,e))}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=p.bind(r);return o.listener=n,r.wrapFn=o,o}function m(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:\"function\"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):v(o,o.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if(\"function\"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(s,\"defaultMaxListeners\",{enumerable:!0,get:function(){return c},set:function(e){if(\"number\"!=typeof e||e<0||a(e))throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received '+e+\".\");c=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if(\"number\"!=typeof e||e<0||a(e))throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received '+e+\".\");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r=\"error\"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error(\"Unhandled error.\"+(a?\" (\"+a.message+\")\":\"\"));throw s.context=a,s}var c=o[e];if(void 0===c)return!1;if(\"function\"==typeof c)i(c,this,t);else{var l=c.length,u=v(c,l);for(n=0;n<l;++n)i(u[n],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){if(\"function\"!=typeof t)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof t);return this.on(e,f(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){if(\"function\"!=typeof t)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,f(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,o,i,a;if(\"function\"!=typeof t)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof t);if(void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit(\"removeListener\",e,n.listener||t));else if(\"function\"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){a=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit(\"removeListener\",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)\"removeListener\"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners(\"removeListener\"),this._events=Object.create(null),this._eventsCount=0,this}if(\"function\"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return m(this,e,!0)},s.prototype.rawListeners=function(e){return m(this,e,!1)},s.listenerCount=function(e,t){return\"function\"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},s.prototype.listenerCount=h,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},419:function(e,t,n){\"use strict\";n.r(t);var r=n(0),o=n.n(r),i=n(26),a=n(295),s=n(1),c=n(4),l=n.n(c);function u(){}var p=function(e,t){var n,r=0,o=1,i={},a=(t=t||{}).maxAttempts||1/0;return i.open=function(){(n=new WebSocket(e,t.protocols||[])).onmessage=t.onmessage||u,n.onopen=function(e){(t.onopen||u)(e),r=0},n.onclose=function(e){1e3===e.code||1001===e.code||1005===e.code||i.reconnect(e),(t.onclose||u)(e)},n.onerror=function(e){e&&\"ECONNREFUSED\"===e.code?i.reconnect(e):(t.onerror||u)(e)}},i.reconnect=function(e){o&&r++<a?o=setTimeout((function(){(t.onreconnect||u)(e),i.open()}),t.timeout||1e3):(t.onmaximum||u)(e)},i.json=function(e){n.send(JSON.stringify(e))},i.send=function(e){n.send(e)},i.close=function(e,t){o=clearTimeout(o),n.close(e||1e3,t)},i.open(),i},f=n(340);class m extends f.EventEmitter{constructor(){super(...arguments),l()(this,\"timer\",null),l()(this,\"backoff\",5e3),l()(this,\"socket\",null),l()(this,\"url\",null),l()(this,\"token\",\"\")}connect(e){return this.url=e,this.socket=new p(\"\".concat(this.url),{onmessage:e=>{try{const{event:t,args:n}=JSON.parse(e.data);n?this.emit(t,...n):this.emit(t)}catch(e){console.warn(\"Failed to parse incoming websocket message.\",e)}},onopen:()=>{this.timer&&clearTimeout(this.timer),this.backoff=5e3,this.emit(\"SOCKET_OPEN\"),this.authenticate()},onreconnect:()=>{this.emit(\"SOCKET_RECONNECT\"),this.authenticate()},onclose:()=>this.emit(\"SOCKET_CLOSE\"),onerror:e=>this.emit(\"SOCKET_ERROR\",e)}),this.timer=setTimeout((()=>{this.backoff=this.backoff+2500>=2e4?2e4:this.backoff+2500,this.socket&&this.socket.close(),clearTimeout(this.timer),this.connect(e)}),this.backoff),this}setToken(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.token=e,t&&this.authenticate(),this}authenticate(){this.url&&this.token&&this.send(\"auth\",this.token)}close(e,t){this.url=null,this.token=\"\",this.socket&&this.socket.close(e,t)}open(){this.socket&&this.socket.open()}reconnect(){this.socket&&this.socket.reconnect()}send(e,t){this.socket&&this.socket.send(JSON.stringify({event:e,args:Array.isArray(t)?t:[t]}))}}var h=n(28),v=n(9),d=e=>new Promise(((t,n)=>{v.a.get(\"/api/client/servers/\".concat(e,\"/websocket\")).then((e=>{let{data:n}=e;return t({token:n.data.token,socket:n.data.socket})})).catch(n)})),y=n(55),b=n(43),g=n(19);const O=[\"jwt: exp claim is invalid\",\"jwt: created too far in past (denylist)\"];var E=()=>{let e=!1;const[t,n]=Object(r.useState)(\"\"),{connected:i,instance:a}=h.a.useStoreState((e=>e.socket)),s=h.a.useStoreState((e=>{var t;return null===(t=e.server.data)||void 0===t?void 0:t.uuid})),c=h.a.useStoreActions((e=>e.status.setServerStatus)),{setInstance:l,setConnectionState:u}=h.a.useStoreActions((e=>e.socket)),p=(t,n)=>{e||(e=!0,d(t).then((e=>n.setToken(e.token,!0))).catch((e=>console.error(e))).then((()=>{e=!1})))},f=e=>{const t=new m;t.on(\"auth success\",(()=>u(!0))),t.on(\"SOCKET_CLOSE\",(()=>u(!1))),t.on(\"SOCKET_ERROR\",(()=>{n(\"connecting\"),u(!1)})),t.on(\"status\",(e=>c(e))),t.on(\"daemon error\",(e=>{console.warn(\"Got error message from daemon socket:\",e)})),t.on(\"token expiring\",(()=>p(e,t))),t.on(\"token expired\",(()=>p(e,t))),t.on(\"jwt error\",(r=>{u(!1),console.warn(\"JWT validation error from wings:\",r),O.find((e=>r.toLowerCase().indexOf(e)>=0))?p(e,t):n(\"There was an error validating the credentials provided for the websocket. Please refresh the page.\")})),t.on(\"transfer status\",(r=>{\"starting\"!==r&&\"success\"!==r&&(t.close(),n(\"connecting\"),u(!1),l(null),f(e))})),d(e).then((e=>{t.setToken(e.token).connect(e.socket),l(t)})).catch((e=>console.error(e)))};return Object(r.useEffect)((()=>{i&&n(\"\")}),[i]),Object(r.useEffect)((()=>()=>{a&&a.close()}),[a]),Object(r.useEffect)((()=>{!a&&s&&f(s)}),[s]),t?o.a.createElement(b.a,{timeout:150,in:!0,appear:!0,classNames:\"fade\"},o.a.createElement(w,null,o.a.createElement(S,null,\"connecting\"===t?o.a.createElement(o.a.Fragment,null,o.a.createElement(g.a,{size:\"small\"}),o.a.createElement(j,null,\"We're having some trouble connecting to your server, please wait...\")):o.a.createElement(k,null,t)))):null},w=Object(s.c)(\"div\").withConfig({displayName:\"WebsocketHandler___StyledDiv\",componentId:\"sc-s2kfyl-0\"})({\"--tw-bg-opacity\":\"1\",backgroundColor:\"rgba(239, 68, 68, var(--tw-bg-opacity))\",paddingTop:\"0.5rem\",paddingBottom:\"0.5rem\"}),S=Object(s.c)(y.a).withConfig({displayName:\"WebsocketHandler___StyledContentContainer\",componentId:\"sc-s2kfyl-1\"})({display:\"flex\",alignItems:\"center\",justifyContent:\"center\"}),j=Object(s.c)(\"p\").withConfig({displayName:\"WebsocketHandler___StyledP\",componentId:\"sc-s2kfyl-2\"})({marginLeft:\"0.5rem\",fontSize:\"0.875rem\",lineHeight:\"1.25rem\",\"--tw-text-opacity\":\"1\",color:\"rgba(254, 226, 226, var(--tw-text-opacity))\"}),k=Object(s.c)(\"p\").withConfig({displayName:\"WebsocketHandler___StyledP2\",componentId:\"sc-s2kfyl-3\"})({marginLeft:\"0.5rem\",fontSize:\"0.875rem\",lineHeight:\"1.25rem\",\"--tw-text-opacity\":\"1\",color:\"rgba(255, 255, 255, var(--tw-text-opacity))\"}),_=n(68),L=n(2),P=n(265),x=n(197),T=n(180),C=n(66),A=n(189);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=()=>{const e=h.a.useStoreState((e=>e.server.data.uuid)),t=h.a.useStoreActions((e=>e.server.getServer)),n=h.a.useStoreActions((e=>e.server.setServerFromState));return Object(x.a)(T.a.BACKUP_RESTORE_COMPLETED,(()=>{Object(C.b)(Object(A.b)(e,\"/\"),void 0),n((e=>R(R({},e),{},{status:null})))})),Object(x.a)(T.a.INSTALL_COMPLETED,(()=>{t(e).catch((e=>console.error(e)))})),Object(x.a)(T.a.INSTALL_STARTED,(()=>{n((e=>R(R({},e),{},{status:\"installing\"})))})),null};function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=()=>{const e=h.a.useStoreState((e=>e.server.data.uuid)),t=h.a.useStoreActions((e=>e.server.getServer)),n=h.a.useStoreActions((e=>e.server.setServerFromState));return Object(x.a)(T.a.TRANSFER_STATUS,(r=>{\"pending\"!==r&&\"processing\"!==r?\"failed\"!==r?\"completed\"===r&&t(e).catch((e=>console.error(e))):n((e=>I(I({},e),{},{isTransferring:!1}))):n((e=>I(I({},e),{},{isTransferring:!0})))})),null},M=n(41),W=n(27),H=n(266),J=n(6),U=n.n(J),z=n(168),B=e=>{let{permission:t,children:n}=e,r=U()(e,[\"permission\",\"children\"]);return o.a.createElement(i.c,r,t?o.a.createElement(z.a,{matchAny:!0,action:t,renderOnError:o.a.createElement(_.b,{title:\"Access Denied\",message:\"You do not have permission to access this page.\"})},n):n)},$=n(17),G=n(293),Y=n(294);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const V=[...new Set(Y.a.server.map((e=>e.identifier)))],X=()=>{const[e,t]=Object(r.useState)(V.reduce(((e,t)=>Q(Q({},e),{},{[t]:[\"-1\"]})),{}));return Object(r.useEffect)((()=>{(async()=>{const e={};for(const t of V){const n=await fetch(\"/api/client/extensions/blueprint/eggs?\".concat(new URLSearchParams({id:t})));e[t]=await n.json()}t(e)})()}),[]),e},Z=()=>{const e=Object(L.useStoreState)((e=>e.user.data.rootAdmin)),t=h.a.useStoreState((e=>{var t;return null===(t=e.server.data)||void 0===t?void 0:t.BlueprintFramework.eggId})),n=Object(i.i)(),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return\"/\"===e?t?n.url:n.path:\"\".concat((t?n.url:n.path).replace(/\\/*$/,\"\"),\"/\").concat(e.replace(/^\\/+/,\"\"))},a=X();return o.a.createElement(o.a.Fragment,null,G.a.server.filter((e=>!!e.name)).map((e=>e.permission?o.a.createElement(z.a,{key:e.path,action:e.permission,matchAny:!0},o.a.createElement(i.b,{to:r(e.path,!0),exact:e.exact},e.name)):o.a.createElement(i.b,{key:e.path,to:r(e.path,!0),exact:e.exact},e.name))),Y.a.server.length>0&&Y.a.server.filter((e=>!!e.name)).filter((t=>!t.adminOnly||e)).filter((e=>!!a[e.identifier].includes(\"-1\")||a[e.identifier].find((e=>e===(null==t?void 0:t.toString()))))).map((e=>e.permission?o.a.createElement(z.a,{key:e.path,action:e.permission,matchAny:!0},o.a.createElement(i.b,{to:r(e.path,!0),exact:e.exact},e.name)):o.a.createElement(i.b,{key:e.path,to:r(e.path,!0),exact:e.exact},e.name))))},ee=()=>{const e=Object(L.useStoreState)((e=>e.user.data.rootAdmin)),t=h.a.useStoreState((e=>{var t;return null===(t=e.server.data)||void 0===t?void 0:t.BlueprintFramework.eggId})),n=Object(i.i)(),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return\"/\"===e?t?n.url:n.path:\"\".concat((t?n.url:n.path).replace(/\\/*$/,\"\"),\"/\").concat(e.replace(/^\\/+/,\"\"))},a=X(),s=Object($.h)();return o.a.createElement(o.a.Fragment,null,o.a.createElement(H.a,null,o.a.createElement(i.e,{location:s},G.a.server.map((e=>{let{path:t,permission:n,component:i}=e;return o.a.createElement(B,{key:t,permission:n,path:r(t),exact:!0},o.a.createElement(g.a.Suspense,null,o.a.createElement(i,null)))})),Y.a.server.length>0&&Y.a.server.filter((t=>!t.adminOnly||e)).filter((e=>!!a[e.identifier].includes(\"-1\")||a[e.identifier].find((e=>e===(null==t?void 0:t.toString()))))).map((e=>{let{path:t,permission:n,component:i}=e;return o.a.createElement(B,{key:t,permission:n,path:r(t),exact:!0},o.a.createElement(g.a.Suspense,null,o.a.createElement(i,null)))})),o.a.createElement(i.c,{path:\"*\",component:_.a}))))};var te=n(280),ne=()=>o.a.createElement(o.a.Fragment,null),re=n(281),oe=n(279);t.default=()=>{const e=Object(i.i)(),t=Object(L.useStoreState)((e=>e.user.data.rootAdmin)),[n,s]=Object(r.useState)(\"\"),c=h.a.useStoreState((e=>{var t;return null===(t=e.server.data)||void 0===t?void 0:t.id})),l=h.a.useStoreState((e=>{var t;return null===(t=e.server.data)||void 0===t?void 0:t.uuid})),u=h.a.useStoreState((e=>{var t;return null===(t=e.server.data)||void 0===t?void 0:t.internalId})),p=h.a.useStoreActions((e=>e.server.getServer)),f=h.a.useStoreActions((e=>e.clearServerState));return Object(r.useEffect)((()=>()=>{f()}),[]),Object(r.useEffect)((()=>(s(\"\"),p(e.params.id).catch((e=>{console.error(e),s(Object(v.c)(e))})),()=>{f()})),[e.params.id]),o.a.createElement(o.a.Fragment,{key:\"server-router\"},o.a.createElement(a.a,null),l&&c?o.a.createElement(o.a.Fragment,null,o.a.createElement(b.a,{timeout:150,classNames:\"fade\",appear:!0,in:!0},o.a.createElement(P.a,{id:\"SubNavigation\"},o.a.createElement(te.a,null),o.a.createElement(\"div\",null,o.a.createElement(Z,null),o.a.createElement(ne,null),t&&o.a.createElement(\"a\",{href:\"/admin/servers/view/\".concat(u),target:\"_blank\"},o.a.createElement(M.a,{icon:W.s}))),o.a.createElement(re.a,null))),o.a.createElement(F,null),o.a.createElement(K,null),o.a.createElement(E,null),o.a.createElement(i.e,null,o.a.createElement(i.c,{path:\"/adblocker-warning\",exact:!0},o.a.createElement(oe.a,null)),o.a.createElement(i.c,{path:e.path},o.a.createElement(ee,null)),o.a.createElement(i.c,{path:\"*\"},o.a.createElement(_.b,{message:\"Page not found\"})))):n?o.a.createElement(_.b,{message:n}):o.a.createElement(g.a,{size:\"large\",centered:!0}))}}}]);","name":"server.5aa792c7.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[6],{\n\n/***/ 340:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = $getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  var args = [];\n  for (var i = 0; i < arguments.length; i++) args.push(arguments[i]);\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    ReflectApply(this.listener, this.target, args);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\n\n/***/ }),\n\n/***/ 419:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(0);\nvar react_default = /*#__PURE__*/__webpack_require__.n(react);\n\n// EXTERNAL MODULE: ./node_modules/react-router-dom/esm/react-router-dom.js\nvar react_router_dom = __webpack_require__(26);\n\n// EXTERNAL MODULE: ./resources/scripts/components/NavigationBar.tsx + 5 modules\nvar NavigationBar = __webpack_require__(295);\n\n// EXTERNAL MODULE: ./node_modules/styled-components/dist/styled-components.browser.esm.js\nvar styled_components_browser_esm = __webpack_require__(1);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/defineProperty.js\nvar defineProperty = __webpack_require__(4);\nvar defineProperty_default = /*#__PURE__*/__webpack_require__.n(defineProperty);\n\n// CONCATENATED MODULE: ./node_modules/sockette/dist/sockette.mjs\nfunction noop() {}\n\n/* harmony default export */ var sockette = (function (url, opts) {\n\topts = opts || {};\n\n\tvar ws, num=0, timer=1, $={};\n\tvar max = opts.maxAttempts || Infinity;\n\n\t$.open = function () {\n\t\tws = new WebSocket(url, opts.protocols || []);\n\n\t\tws.onmessage = opts.onmessage || noop;\n\n\t\tws.onopen = function (e) {\n\t\t\t(opts.onopen || noop)(e);\n\t\t\tnum = 0;\n\t\t};\n\n\t\tws.onclose = function (e) {\n\t\t\te.code === 1e3 || e.code === 1001 || e.code === 1005 || $.reconnect(e);\n\t\t\t(opts.onclose || noop)(e);\n\t\t};\n\n\t\tws.onerror = function (e) {\n\t\t\t(e && e.code==='ECONNREFUSED') ? $.reconnect(e) : (opts.onerror || noop)(e);\n\t\t};\n\t};\n\n\t$.reconnect = function (e) {\n\t\tif (timer && num++ < max) {\n\t\t\ttimer = setTimeout(function () {\n\t\t\t\t(opts.onreconnect || noop)(e);\n\t\t\t\t$.open();\n\t\t\t}, opts.timeout || 1e3);\n\t\t} else {\n\t\t\t(opts.onmaximum || noop)(e);\n\t\t}\n\t};\n\n\t$.json = function (x) {\n\t\tws.send(JSON.stringify(x));\n\t};\n\n\t$.send = function (x) {\n\t\tws.send(x);\n\t};\n\n\t$.close = function (x, y) {\n\t\ttimer = clearTimeout(timer);\n\t\tws.close(x || 1e3, y);\n\t};\n\n\t$.open(); // init\n\n\treturn $;\n});\n\n// EXTERNAL MODULE: ./node_modules/events/events.js\nvar events = __webpack_require__(340);\n\n// CONCATENATED MODULE: ./resources/scripts/plugins/Websocket.ts\n\n\n\nclass Websocket_Websocket extends events[\"EventEmitter\"] {\n  constructor() {\n    super(...arguments);\n\n    defineProperty_default()(this, \"timer\", null);\n\n    defineProperty_default()(this, \"backoff\", 5000);\n\n    defineProperty_default()(this, \"socket\", null);\n\n    defineProperty_default()(this, \"url\", null);\n\n    defineProperty_default()(this, \"token\", '');\n  }\n\n  // Connects to the websocket instance and sets the token for the initial request.\n  connect(url) {\n    this.url = url;\n    this.socket = new sockette(\"\".concat(this.url), {\n      onmessage: e => {\n        try {\n          const {\n            event,\n            args\n          } = JSON.parse(e.data);\n          args ? this.emit(event, ...args) : this.emit(event);\n        } catch (ex) {\n          console.warn('Failed to parse incoming websocket message.', ex);\n        }\n      },\n      onopen: () => {\n        // Clear the timers, we managed to connect just fine.\n        this.timer && clearTimeout(this.timer);\n        this.backoff = 5000;\n        this.emit('SOCKET_OPEN');\n        this.authenticate();\n      },\n      onreconnect: () => {\n        this.emit('SOCKET_RECONNECT');\n        this.authenticate();\n      },\n      onclose: () => this.emit('SOCKET_CLOSE'),\n      onerror: error => this.emit('SOCKET_ERROR', error)\n    });\n    this.timer = setTimeout(() => {\n      this.backoff = this.backoff + 2500 >= 20000 ? 20000 : this.backoff + 2500;\n      this.socket && this.socket.close();\n      clearTimeout(this.timer); // Re-attempt connecting to the socket.\n\n      this.connect(url);\n    }, this.backoff);\n    return this;\n  } // Sets the authentication token to use when sending commands back and forth\n  // between the websocket instance.\n\n\n  setToken(token) {\n    let isUpdate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    this.token = token;\n\n    if (isUpdate) {\n      this.authenticate();\n    }\n\n    return this;\n  }\n\n  authenticate() {\n    if (this.url && this.token) {\n      this.send('auth', this.token);\n    }\n  }\n\n  close(code, reason) {\n    this.url = null;\n    this.token = '';\n    this.socket && this.socket.close(code, reason);\n  }\n\n  open() {\n    this.socket && this.socket.open();\n  }\n\n  reconnect() {\n    this.socket && this.socket.reconnect();\n  }\n\n  send(event, payload) {\n    this.socket && this.socket.send(JSON.stringify({\n      event,\n      args: Array.isArray(payload) ? payload : [payload]\n    }));\n  }\n\n}\n// EXTERNAL MODULE: ./resources/scripts/state/server/index.ts + 5 modules\nvar state_server = __webpack_require__(28);\n\n// EXTERNAL MODULE: ./resources/scripts/api/http.ts\nvar http = __webpack_require__(9);\n\n// CONCATENATED MODULE: ./resources/scripts/api/server/getWebsocketToken.ts\n\n/* harmony default export */ var getWebsocketToken = (server => {\n  return new Promise((resolve, reject) => {\n    http[\"a\" /* default */].get(\"/api/client/servers/\".concat(server, \"/websocket\")).then(_ref => {\n      let {\n        data\n      } = _ref;\n      return resolve({\n        token: data.data.token,\n        socket: data.data.socket\n      });\n    }).catch(reject);\n  });\n});\n// EXTERNAL MODULE: ./resources/scripts/components/elements/ContentContainer.tsx\nvar ContentContainer = __webpack_require__(55);\n\n// EXTERNAL MODULE: ./node_modules/react-transition-group/esm/index.js + 4 modules\nvar esm = __webpack_require__(43);\n\n// EXTERNAL MODULE: ./resources/scripts/components/elements/Spinner.tsx\nvar Spinner = __webpack_require__(19);\n\n// CONCATENATED MODULE: ./resources/scripts/components/server/WebsocketHandler.tsx\n\n\n\n\n\n\n\n\n\n\n\nconst reconnectErrors = ['jwt: exp claim is invalid', 'jwt: created too far in past (denylist)'];\n/* harmony default export */ var WebsocketHandler = (() => {\n  let updatingToken = false;\n  const [error, setError] = Object(react[\"useState\"])('');\n  const {\n    connected,\n    instance\n  } = state_server[\"a\" /* ServerContext */].useStoreState(state => state.socket);\n  const uuid = state_server[\"a\" /* ServerContext */].useStoreState(state => {\n    var _state$server$data;\n\n    return (_state$server$data = state.server.data) === null || _state$server$data === void 0 ? void 0 : _state$server$data.uuid;\n  });\n  const setServerStatus = state_server[\"a\" /* ServerContext */].useStoreActions(actions => actions.status.setServerStatus);\n  const {\n    setInstance,\n    setConnectionState\n  } = state_server[\"a\" /* ServerContext */].useStoreActions(actions => actions.socket);\n\n  const updateToken = (uuid, socket) => {\n    if (updatingToken) return;\n    updatingToken = true;\n    getWebsocketToken(uuid).then(data => socket.setToken(data.token, true)).catch(error => console.error(error)).then(() => {\n      updatingToken = false;\n    });\n  };\n\n  const connect = uuid => {\n    const socket = new Websocket_Websocket();\n    socket.on('auth success', () => setConnectionState(true));\n    socket.on('SOCKET_CLOSE', () => setConnectionState(false));\n    socket.on('SOCKET_ERROR', () => {\n      setError('connecting');\n      setConnectionState(false);\n    });\n    socket.on('status', status => setServerStatus(status));\n    socket.on('daemon error', message => {\n      console.warn('Got error message from daemon socket:', message);\n    });\n    socket.on('token expiring', () => updateToken(uuid, socket));\n    socket.on('token expired', () => updateToken(uuid, socket));\n    socket.on('jwt error', error => {\n      setConnectionState(false);\n      console.warn('JWT validation error from wings:', error);\n\n      if (reconnectErrors.find(v => error.toLowerCase().indexOf(v) >= 0)) {\n        updateToken(uuid, socket);\n      } else {\n        setError('There was an error validating the credentials provided for the websocket. Please refresh the page.');\n      }\n    });\n    socket.on('transfer status', status => {\n      if (status === 'starting' || status === 'success') {\n        return;\n      } // This code forces a reconnection to the websocket which will connect us to the target node instead of the source node\n      // in order to be able to receive transfer logs from the target node.\n\n\n      socket.close();\n      setError('connecting');\n      setConnectionState(false);\n      setInstance(null);\n      connect(uuid);\n    });\n    getWebsocketToken(uuid).then(data => {\n      // Connect and then set the authentication token.\n      socket.setToken(data.token).connect(data.socket); // Once that is done, set the instance.\n\n      setInstance(socket);\n    }).catch(error => console.error(error));\n  };\n\n  Object(react[\"useEffect\"])(() => {\n    connected && setError('');\n  }, [connected]);\n  Object(react[\"useEffect\"])(() => {\n    return () => {\n      instance && instance.close();\n    };\n  }, [instance]);\n  Object(react[\"useEffect\"])(() => {\n    // If there is already an instance or there is no server, just exit out of this process\n    // since we don't need to make a new connection.\n    if (instance || !uuid) {\n      return;\n    }\n\n    connect(uuid);\n  }, [uuid]);\n  return error ? /*#__PURE__*/react_default.a.createElement(esm[\"a\" /* CSSTransition */], {\n    timeout: 150,\n    in: true,\n    appear: true,\n    classNames: 'fade'\n  }, /*#__PURE__*/react_default.a.createElement(_StyledDiv, null, /*#__PURE__*/react_default.a.createElement(_StyledContentContainer, null, error === 'connecting' ? /*#__PURE__*/react_default.a.createElement(react_default.a.Fragment, null, /*#__PURE__*/react_default.a.createElement(Spinner[\"a\" /* default */], {\n    size: 'small'\n  }), /*#__PURE__*/react_default.a.createElement(_StyledP, null, \"We're having some trouble connecting to your server, please wait...\")) : /*#__PURE__*/react_default.a.createElement(_StyledP2, null, error)))) : null;\n});\n\nvar _StyledDiv = Object(styled_components_browser_esm[\"c\" /* default */])(\"div\").withConfig({\n  displayName: \"WebsocketHandler___StyledDiv\",\n  componentId: \"sc-s2kfyl-0\"\n})({\n  \"--tw-bg-opacity\": \"1\",\n  \"backgroundColor\": \"rgba(239, 68, 68, var(--tw-bg-opacity))\",\n  \"paddingTop\": \"0.5rem\",\n  \"paddingBottom\": \"0.5rem\"\n});\n\nvar _StyledContentContainer = Object(styled_components_browser_esm[\"c\" /* default */])(ContentContainer[\"a\" /* default */]).withConfig({\n  displayName: \"WebsocketHandler___StyledContentContainer\",\n  componentId: \"sc-s2kfyl-1\"\n})({\n  \"display\": \"flex\",\n  \"alignItems\": \"center\",\n  \"justifyContent\": \"center\"\n});\n\nvar _StyledP = Object(styled_components_browser_esm[\"c\" /* default */])(\"p\").withConfig({\n  displayName: \"WebsocketHandler___StyledP\",\n  componentId: \"sc-s2kfyl-2\"\n})({\n  \"marginLeft\": \"0.5rem\",\n  \"fontSize\": \"0.875rem\",\n  \"lineHeight\": \"1.25rem\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgba(254, 226, 226, var(--tw-text-opacity))\"\n});\n\nvar _StyledP2 = Object(styled_components_browser_esm[\"c\" /* default */])(\"p\").withConfig({\n  displayName: \"WebsocketHandler___StyledP2\",\n  componentId: \"sc-s2kfyl-3\"\n})({\n  \"marginLeft\": \"0.5rem\",\n  \"fontSize\": \"0.875rem\",\n  \"lineHeight\": \"1.25rem\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgba(255, 255, 255, var(--tw-text-opacity))\"\n});\n// EXTERNAL MODULE: ./resources/scripts/components/elements/ScreenBlock.tsx\nvar ScreenBlock = __webpack_require__(68);\n\n// EXTERNAL MODULE: ./node_modules/easy-peasy/dist/easy-peasy.js\nvar easy_peasy = __webpack_require__(2);\n\n// EXTERNAL MODULE: ./resources/scripts/components/elements/SubNavigation.tsx\nvar SubNavigation = __webpack_require__(265);\n\n// EXTERNAL MODULE: ./resources/scripts/plugins/useWebsocketEvent.ts\nvar useWebsocketEvent = __webpack_require__(197);\n\n// EXTERNAL MODULE: ./resources/scripts/components/server/events.ts\nvar server_events = __webpack_require__(180);\n\n// EXTERNAL MODULE: ./node_modules/swr/esm/index.js + 9 modules\nvar swr_esm = __webpack_require__(66);\n\n// EXTERNAL MODULE: ./resources/scripts/plugins/useFileManagerSwr.ts + 1 modules\nvar useFileManagerSwr = __webpack_require__(189);\n\n// CONCATENATED MODULE: ./resources/scripts/components/server/InstallListener.tsx\n\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { defineProperty_default()(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n\n\n\n\n\n\nconst InstallListener = () => {\n  const uuid = state_server[\"a\" /* ServerContext */].useStoreState(state => state.server.data.uuid);\n  const getServer = state_server[\"a\" /* ServerContext */].useStoreActions(actions => actions.server.getServer);\n  const setServerFromState = state_server[\"a\" /* ServerContext */].useStoreActions(actions => actions.server.setServerFromState);\n  Object(useWebsocketEvent[\"a\" /* default */])(server_events[\"a\" /* SocketEvent */].BACKUP_RESTORE_COMPLETED, () => {\n    Object(swr_esm[\"b\" /* mutate */])(Object(useFileManagerSwr[\"b\" /* getDirectorySwrKey */])(uuid, '/'), undefined);\n    setServerFromState(s => _objectSpread(_objectSpread({}, s), {}, {\n      status: null\n    }));\n  }); // Listen for the installation completion event and then fire off a request to fetch the updated\n  // server information. This allows the server to automatically become available to the user if they\n  // just sit on the page.\n\n  Object(useWebsocketEvent[\"a\" /* default */])(server_events[\"a\" /* SocketEvent */].INSTALL_COMPLETED, () => {\n    getServer(uuid).catch(error => console.error(error));\n  }); // When we see the install started event immediately update the state to indicate such so that the\n  // screens automatically update.\n\n  Object(useWebsocketEvent[\"a\" /* default */])(server_events[\"a\" /* SocketEvent */].INSTALL_STARTED, () => {\n    setServerFromState(s => _objectSpread(_objectSpread({}, s), {}, {\n      status: 'installing'\n    }));\n  });\n  return null;\n};\n\n/* harmony default export */ var server_InstallListener = (InstallListener);\n// CONCATENATED MODULE: ./resources/scripts/components/server/TransferListener.tsx\n\n\nfunction TransferListener_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction TransferListener_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? TransferListener_ownKeys(Object(source), !0).forEach(function (key) { defineProperty_default()(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : TransferListener_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n\n\n\n\nconst TransferListener = () => {\n  const uuid = state_server[\"a\" /* ServerContext */].useStoreState(state => state.server.data.uuid);\n  const getServer = state_server[\"a\" /* ServerContext */].useStoreActions(actions => actions.server.getServer);\n  const setServerFromState = state_server[\"a\" /* ServerContext */].useStoreActions(actions => actions.server.setServerFromState); // Listen for the transfer status event, so we can update the state of the server.\n\n  Object(useWebsocketEvent[\"a\" /* default */])(server_events[\"a\" /* SocketEvent */].TRANSFER_STATUS, status => {\n    if (status === 'pending' || status === 'processing') {\n      setServerFromState(s => TransferListener_objectSpread(TransferListener_objectSpread({}, s), {}, {\n        isTransferring: true\n      }));\n      return;\n    }\n\n    if (status === 'failed') {\n      setServerFromState(s => TransferListener_objectSpread(TransferListener_objectSpread({}, s), {}, {\n        isTransferring: false\n      }));\n      return;\n    }\n\n    if (status !== 'completed') {\n      return;\n    } // Refresh the server's information as it's node and allocations were just updated.\n\n\n    getServer(uuid).catch(error => console.error(error));\n  });\n  return null;\n};\n\n/* harmony default export */ var server_TransferListener = (TransferListener);\n// EXTERNAL MODULE: ./node_modules/@fortawesome/react-fontawesome/index.es.js\nvar index_es = __webpack_require__(41);\n\n// EXTERNAL MODULE: ./node_modules/@fortawesome/free-solid-svg-icons/index.es.js\nvar free_solid_svg_icons_index_es = __webpack_require__(27);\n\n// EXTERNAL MODULE: ./resources/scripts/TransitionRouter.tsx\nvar TransitionRouter = __webpack_require__(266);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/objectWithoutProperties.js\nvar objectWithoutProperties = __webpack_require__(6);\nvar objectWithoutProperties_default = /*#__PURE__*/__webpack_require__.n(objectWithoutProperties);\n\n// EXTERNAL MODULE: ./resources/scripts/components/elements/Can.tsx\nvar Can = __webpack_require__(168);\n\n// CONCATENATED MODULE: ./resources/scripts/components/elements/PermissionRoute.tsx\n\n\n\n\n\n/* harmony default export */ var PermissionRoute = (_ref => {\n  let {\n    permission,\n    children\n  } = _ref,\n      props = objectWithoutProperties_default()(_ref, [\"permission\", \"children\"]);\n\n  return /*#__PURE__*/react_default.a.createElement(react_router_dom[\"c\" /* Route */], props, !permission ? children : /*#__PURE__*/react_default.a.createElement(Can[\"a\" /* default */], {\n    matchAny: true,\n    action: permission,\n    renderOnError: /*#__PURE__*/react_default.a.createElement(ScreenBlock[\"b\" /* ServerError */], {\n      title: 'Access Denied',\n      message: 'You do not have permission to access this page.'\n    })\n  }, children));\n});\n// EXTERNAL MODULE: ./node_modules/react-router/esm/react-router.js + 1 modules\nvar react_router = __webpack_require__(17);\n\n// EXTERNAL MODULE: ./resources/scripts/routers/routes.ts + 153 modules\nvar routes = __webpack_require__(293);\n\n// EXTERNAL MODULE: ./resources/scripts/blueprint/extends/routers/routes.ts + 6 modules\nvar routers_routes = __webpack_require__(294);\n\n// CONCATENATED MODULE: ./resources/scripts/blueprint/extends/routers/ServerRouter.tsx\n\n\nfunction ServerRouter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction ServerRouter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ServerRouter_ownKeys(Object(source), !0).forEach(function (key) { defineProperty_default()(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ServerRouter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst blueprintExtensions = [...new Set(routers_routes[\"a\" /* default */].server.map(route => route.identifier))];\n/**\n * Get the route egg IDs for each extension with server routes.\n */\n\nconst useExtensionEggs = () => {\n  const [extensionEggs, setExtensionEggs] = Object(react[\"useState\"])(blueprintExtensions.reduce((prev, current) => ServerRouter_objectSpread(ServerRouter_objectSpread({}, prev), {}, {\n    [current]: ['-1']\n  }), {}));\n  Object(react[\"useEffect\"])(() => {\n    (async () => {\n      const newEggs = {};\n\n      for (const id of blueprintExtensions) {\n        const resp = await fetch(\"/api/client/extensions/blueprint/eggs?\".concat(new URLSearchParams({\n          id\n        })));\n        newEggs[id] = await resp.json();\n      }\n\n      setExtensionEggs(newEggs);\n    })();\n  }, []);\n  return extensionEggs;\n};\n\nconst NavigationLinks = () => {\n  const rootAdmin = Object(easy_peasy[\"useStoreState\"])(state => state.user.data.rootAdmin);\n  const serverEgg = state_server[\"a\" /* ServerContext */].useStoreState(state => {\n    var _state$server$data;\n\n    return (_state$server$data = state.server.data) === null || _state$server$data === void 0 ? void 0 : _state$server$data.BlueprintFramework.eggId;\n  });\n  const match = Object(react_router_dom[\"i\" /* useRouteMatch */])();\n\n  const to = function (value) {\n    let url = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    if (value === '/') {\n      return url ? match.url : match.path;\n    }\n\n    return \"\".concat((url ? match.url : match.path).replace(/\\/*$/, ''), \"/\").concat(value.replace(/^\\/+/, ''));\n  };\n\n  const extensionEggs = useExtensionEggs();\n  return /*#__PURE__*/react_default.a.createElement(react_default.a.Fragment, null, routes[\"a\" /* default */].server.filter(route => !!route.name).map(route => route.permission ? /*#__PURE__*/react_default.a.createElement(Can[\"a\" /* default */], {\n    key: route.path,\n    action: route.permission,\n    matchAny: true\n  }, /*#__PURE__*/react_default.a.createElement(react_router_dom[\"b\" /* NavLink */], {\n    to: to(route.path, true),\n    exact: route.exact\n  }, route.name)) : /*#__PURE__*/react_default.a.createElement(react_router_dom[\"b\" /* NavLink */], {\n    key: route.path,\n    to: to(route.path, true),\n    exact: route.exact\n  }, route.name)), routers_routes[\"a\" /* default */].server.length > 0 && routers_routes[\"a\" /* default */].server.filter(route => !!route.name).filter(route => route.adminOnly ? rootAdmin : true).filter(route => extensionEggs[route.identifier].includes('-1') ? true : extensionEggs[route.identifier].find(id => id === (serverEgg === null || serverEgg === void 0 ? void 0 : serverEgg.toString()))).map(route => route.permission ? /*#__PURE__*/react_default.a.createElement(Can[\"a\" /* default */], {\n    key: route.path,\n    action: route.permission,\n    matchAny: true\n  }, /*#__PURE__*/react_default.a.createElement(react_router_dom[\"b\" /* NavLink */], {\n    to: to(route.path, true),\n    exact: route.exact\n  }, route.name)) : /*#__PURE__*/react_default.a.createElement(react_router_dom[\"b\" /* NavLink */], {\n    key: route.path,\n    to: to(route.path, true),\n    exact: route.exact\n  }, route.name)));\n};\nconst NavigationRouter = () => {\n  const rootAdmin = Object(easy_peasy[\"useStoreState\"])(state => state.user.data.rootAdmin);\n  const serverEgg = state_server[\"a\" /* ServerContext */].useStoreState(state => {\n    var _state$server$data2;\n\n    return (_state$server$data2 = state.server.data) === null || _state$server$data2 === void 0 ? void 0 : _state$server$data2.BlueprintFramework.eggId;\n  });\n  const match = Object(react_router_dom[\"i\" /* useRouteMatch */])();\n\n  const to = function (value) {\n    let url = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    if (value === '/') {\n      return url ? match.url : match.path;\n    }\n\n    return \"\".concat((url ? match.url : match.path).replace(/\\/*$/, ''), \"/\").concat(value.replace(/^\\/+/, ''));\n  };\n\n  const extensionEggs = useExtensionEggs();\n  const location = Object(react_router[\"h\" /* useLocation */])();\n  return /*#__PURE__*/react_default.a.createElement(react_default.a.Fragment, null, /*#__PURE__*/react_default.a.createElement(TransitionRouter[\"a\" /* default */], null, /*#__PURE__*/react_default.a.createElement(react_router_dom[\"e\" /* Switch */], {\n    location: location\n  }, routes[\"a\" /* default */].server.map(_ref => {\n    let {\n      path,\n      permission,\n      component: Component\n    } = _ref;\n    return /*#__PURE__*/react_default.a.createElement(PermissionRoute, {\n      key: path,\n      permission: permission,\n      path: to(path),\n      exact: true\n    }, /*#__PURE__*/react_default.a.createElement(Spinner[\"a\" /* default */].Suspense, null, /*#__PURE__*/react_default.a.createElement(Component, null)));\n  }), routers_routes[\"a\" /* default */].server.length > 0 && routers_routes[\"a\" /* default */].server.filter(route => route.adminOnly ? rootAdmin : true).filter(route => extensionEggs[route.identifier].includes('-1') ? true : extensionEggs[route.identifier].find(id => id === (serverEgg === null || serverEgg === void 0 ? void 0 : serverEgg.toString()))).map(_ref2 => {\n    let {\n      path,\n      permission,\n      component: Component\n    } = _ref2;\n    return /*#__PURE__*/react_default.a.createElement(PermissionRoute, {\n      key: path,\n      permission: permission,\n      path: to(path),\n      exact: true\n    }, /*#__PURE__*/react_default.a.createElement(Spinner[\"a\" /* default */].Suspense, null, /*#__PURE__*/react_default.a.createElement(Component, null)));\n  }), /*#__PURE__*/react_default.a.createElement(react_router_dom[\"c\" /* Route */], {\n    path: '*',\n    component: ScreenBlock[\"a\" /* NotFound */]\n  }))));\n};\n// EXTERNAL MODULE: ./resources/scripts/blueprint/components/Navigation/SubNavigation/BeforeSubNavigation.tsx\nvar BeforeSubNavigation = __webpack_require__(280);\n\n// CONCATENATED MODULE: ./resources/scripts/blueprint/components/Navigation/SubNavigation/AdditionalServerItems.tsx\n\n/* blueprint/import */\n\n/* harmony default export */ var AdditionalServerItems = (() => {\n  return /*#__PURE__*/react_default.a.createElement(react_default.a.Fragment, null);\n});\n// EXTERNAL MODULE: ./resources/scripts/blueprint/components/Navigation/SubNavigation/AfterSubNavigation.tsx\nvar AfterSubNavigation = __webpack_require__(281);\n\n// EXTERNAL MODULE: ./resources/scripts/components/adblockWarning.tsx\nvar adblockWarning = __webpack_require__(279);\n\n// CONCATENATED MODULE: ./resources/scripts/routers/ServerRouter.tsx\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n // Import AdBlockWarning component\n\n\n\nconst ServerRouter = () => {\n  const match = Object(react_router_dom[\"i\" /* useRouteMatch */])();\n  const rootAdmin = Object(easy_peasy[\"useStoreState\"])(state => state.user.data.rootAdmin);\n  const [error, setError] = Object(react[\"useState\"])('');\n  const id = state_server[\"a\" /* ServerContext */].useStoreState(state => {\n    var _state$server$data;\n\n    return (_state$server$data = state.server.data) === null || _state$server$data === void 0 ? void 0 : _state$server$data.id;\n  });\n  const uuid = state_server[\"a\" /* ServerContext */].useStoreState(state => {\n    var _state$server$data2;\n\n    return (_state$server$data2 = state.server.data) === null || _state$server$data2 === void 0 ? void 0 : _state$server$data2.uuid;\n  });\n  const serverId = state_server[\"a\" /* ServerContext */].useStoreState(state => {\n    var _state$server$data3;\n\n    return (_state$server$data3 = state.server.data) === null || _state$server$data3 === void 0 ? void 0 : _state$server$data3.internalId;\n  });\n  const getServer = state_server[\"a\" /* ServerContext */].useStoreActions(actions => actions.server.getServer);\n  const clearServerState = state_server[\"a\" /* ServerContext */].useStoreActions(actions => actions.clearServerState);\n  Object(react[\"useEffect\"])(() => {\n    return () => {\n      clearServerState();\n    };\n  }, []);\n  Object(react[\"useEffect\"])(() => {\n    setError('');\n    getServer(match.params.id).catch(error => {\n      console.error(error);\n      setError(Object(http[\"c\" /* httpErrorToHuman */])(error));\n    });\n    return () => {\n      clearServerState();\n    };\n  }, [match.params.id]);\n  return /*#__PURE__*/react_default.a.createElement(react_default.a.Fragment, {\n    key: 'server-router'\n  }, /*#__PURE__*/react_default.a.createElement(NavigationBar[\"a\" /* default */], null), !uuid || !id ? error ? /*#__PURE__*/react_default.a.createElement(ScreenBlock[\"b\" /* ServerError */], {\n    message: error\n  }) : /*#__PURE__*/react_default.a.createElement(Spinner[\"a\" /* default */], {\n    size: 'large',\n    centered: true\n  }) : /*#__PURE__*/react_default.a.createElement(react_default.a.Fragment, null, /*#__PURE__*/react_default.a.createElement(esm[\"a\" /* CSSTransition */], {\n    timeout: 150,\n    classNames: 'fade',\n    appear: true,\n    in: true\n  }, /*#__PURE__*/react_default.a.createElement(SubNavigation[\"a\" /* default */], {\n    id: 'SubNavigation'\n  }, /*#__PURE__*/react_default.a.createElement(BeforeSubNavigation[\"a\" /* default */], null), /*#__PURE__*/react_default.a.createElement(\"div\", null, /*#__PURE__*/react_default.a.createElement(NavigationLinks, null), /*#__PURE__*/react_default.a.createElement(AdditionalServerItems, null), rootAdmin &&\n  /*#__PURE__*/\n  // eslint-disable-next-line react/jsx-no-target-blank\n  react_default.a.createElement(\"a\", {\n    href: \"/admin/servers/view/\".concat(serverId),\n    target: '_blank'\n  }, /*#__PURE__*/react_default.a.createElement(index_es[\"a\" /* FontAwesomeIcon */], {\n    icon: free_solid_svg_icons_index_es[\"s\" /* faExternalLinkAlt */]\n  }))), /*#__PURE__*/react_default.a.createElement(AfterSubNavigation[\"a\" /* default */], null))), /*#__PURE__*/react_default.a.createElement(server_InstallListener, null), /*#__PURE__*/react_default.a.createElement(server_TransferListener, null), /*#__PURE__*/react_default.a.createElement(WebsocketHandler, null), /*#__PURE__*/react_default.a.createElement(react_router_dom[\"e\" /* Switch */], null, /*#__PURE__*/react_default.a.createElement(react_router_dom[\"c\" /* Route */], {\n    path: '/adblocker-warning',\n    exact: true\n  }, /*#__PURE__*/react_default.a.createElement(adblockWarning[\"a\" /* default */], null)), /*#__PURE__*/react_default.a.createElement(react_router_dom[\"c\" /* Route */], {\n    path: match.path\n  }, /*#__PURE__*/react_default.a.createElement(NavigationRouter, null)), /*#__PURE__*/react_default.a.createElement(react_router_dom[\"c\" /* Route */], {\n    path: \"*\"\n  }, /*#__PURE__*/react_default.a.createElement(ScreenBlock[\"b\" /* ServerError */], {\n    message: \"Page not found\"\n  })))));\n};\n\n/* harmony default export */ var routers_ServerRouter = __webpack_exports__[\"default\"] = (ServerRouter);\n\n/***/ })\n\n}]);","inputSourceMap":null}